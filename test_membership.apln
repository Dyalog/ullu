:Namespace test_membership
    ∇ ret←assert arg ;r;testID;i;miscData;stop;verbose;FAIL_OK ⍝ to evauate result
        verbose←#.unittest.verbose
        stop←#.unittest.stop

        r←⊃arg
        testID←2⊃arg
        i←3⊃arg
        miscData←4⊃arg

        ret←0 1
        leave←0
        FAIL_OK←'[FAIL]' '[OK]' ⍝ 1+bool will give fail and ok on 0 and 1

        :If (~r)∧stop
            ⎕←testID,' ', miscData, ': ', FAIL_OK[1+r]
            ⎕←'Stopping on failure of:' ⋄ ⎕←(6⍴' '), testID
            leave←1
        :EndIf
        :If verbose
            ⎕←testID,' ', miscData, ':', FAIL_OK[1+r]
        :ElseIf ~r∨stop
            ⎕←testID,' ', miscData, ':', FAIL_OK[1+r]
        :EndIf
        i←i+1
        ret←r i leave
    ∇

    ⍝ This section of testcases are categorised based on the ⎕DR model.
    ⍝ Read more: https://help.dyalog.com/latest/#Language/System%20Functions/Data%20Representation%20Monadic.htm
    :Section Based on DR
        ∇ r←Test_DR ;bool;i1;char1;char2;i2;char3;i3;ptr;dbl;fl;cmplx;data;i
            bool←0 1 ⍝ 11: 1 bit Boolean type arrays
            i1←¯60+⍳120 ⍝ 83: 8 bits signed integer
            char1←⎕UCS ⍳255 ⍝ 80: 8 bits character
            char2←⎕UCS ⍳10000 ⍝ 160: 16 bits character
            i2←{⍵,-⍵}10000+⍳1000 ⍝ 163: 16 bits signed integer
            char3←⎕UCS ⍳100000 ⍝ 320: 32 bits character
            i3←{⍵,-⍵}100000+⍳1000 ⍝ 323: 32 bits signed  integer
            ptr←2,/⎕A ⍝ 326: Pointer (32-bit or 64-bit as appropriate)
            dbl←{⍵,-⍵}i3+0.1 ⍝ 645: 64 bits Floating
            ⍝ todo: figure out how to change ⎕fr for fl
            fl←dbl ⍝ 1287: 128 bits Decimal
            cmplx←{⍵,-⍵}(0J1×⍳10000)+⌽⍳10000 ⍝ 1289: 128 bits Complex

            r←38⍴0 ⍝ number of tests is 38
            i←0 ⍝ iterator
            :For data :In bool i1 i2 i3 dbl char1 char2 char3 ptr cmplx
                :If 11≠type←⎕DR data
                    r[i] i leave←assert ((data[?≢data])∊data) 't1' i ('for ⎕DR', ⎕DR data)  ⍝ random element is found
                    :If leave
                        :Leave 
                    :EndIf
                    r[i] i leave←assert (((((≢data)-1)⍴0), 1)≡data∊(¯1↑data)) 't2' i ('for ⎕DR', ⎕DR data) ⍝ All elements return 0 except last
                    :If leave
                        :Leave 
                    :EndIf
                    r[i] i leave←assert (((≢data)⍴1)≡data∊data) 't3' i ('for ⎕DR', ⎕DR data) ⍝ all elements return 1
                    :If leave
                        :Leave 
                    :EndIf
                    :If (80≠type←⎕DR data)∧(160≠type←⎕DR data)∧(320≠type←⎕DR data)⍝ ⎕UCS conversion reqd for char
                        :If 326=type←⎕DR data ⍝ not relevant for ptr
                            :continue
                        :EndIf
                        r[i] i leave←assert (~((1⊃data)-1)∊data) 't4.1' i ('for ⎕DR', ⎕DR data) ⍝ element outside set is not found
                        :If leave
                            :Leave 
                        :EndIf
                    :Else
                        r[i] i leave←assert (~(⎕UCS((⎕UCS(1⊃data))-1))∊data) 't4.2' i ('for ⎕DR', ⎕DR data) ⍝ element outside set is not found
                        :If leave
                            :Leave 
                        :EndIf
                    :EndIf
                    ⍝ Todo: add more tests
                :Else ⍝ Booleans need special tests
                    ⍝ Boolean tests here because the domain is so small
                    r[i] i leave←assert (0∊0) 'tb1' i ('for ⎕DR', ⎕DR data)
                    :If leave
                        :Leave 
                    :EndIf
                    r[i] i leave←assert (~0∊1) 'tb2' i ('for ⎕DR', ⎕DR data)
                    :If leave
                        :Leave 
                    :EndIf
                    r[i] i leave←assert (1 1≡bool∊bool) 'tb3' i ('for ⎕DR', ⎕DR bool)
                    :If leave
                        :Leave
                    :EndIf
                :EndIf
            :EndFor
        ∇
    :EndSection

    ⍝ Tests based upon ⎕CT value
    ⍝ Read more: https://help.dyalog.com/latest/#Language/System%20Functions/ct.htm
    :Section Based on CT
        ⍝ TODO
    :EndSection

:EndNamespace
